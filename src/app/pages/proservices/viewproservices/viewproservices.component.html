<!-- ðŸŒ Main Page Container -->
<div class="p-10 space-y-8" *ngIf="permission.parmissionMatched(['View Service'])">
  <div class="min-h-screen bg-gray-50 dark:bg-gray-900 py-0 flex flex-col">
    <main class="flex-1 flex justify-center items-start mt-10">
      <div class="w-full max-w-7xl bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-10">

        <!-- ðŸ”¤ Header Section -->
        <div class="flex flex-col sm:flex-row justify-between items-center mb-6">
          <h2 class="text-3xl font-extrabold text-blue-700 dark:text-blue-400 mb-3 sm:mb-0">
            {{ currentLanguage === 'sw' ? 'Huduma Zilizowekwa' : 'Assigned Services' }}
          </h2>

          <div class="flex space-x-2">
            <button
              class="px-4 py-1.5 text-sm font-semibold rounded-full border transition-all duration-200"
              [class.bg-blue-600]="currentLanguage === 'en'"
              [class.text-white]="currentLanguage === 'en'"
              [class.text-blue-600]="currentLanguage !== 'en'"
              [class.border-blue-600]="currentLanguage !== 'en'"
              (click)="switchLanguage('en')"
            >
              English
            </button>
            <button
              class="px-4 py-1.5 text-sm font-semibold rounded-full border transition-all duration-200"
              [class.bg-green-600]="currentLanguage === 'sw'"
              [class.text-white]="currentLanguage === 'sw'"
              [class.text-green-600]="currentLanguage !== 'sw'"
              [class.border-green-600]="currentLanguage !== 'sw'"
              (click)="switchLanguage('sw')"
            >
              Kiswahili
            </button>
          </div>
        </div>

        <!-- ðŸ” Search and Refresh Controls -->
        <div class="flex flex-col sm:flex-row justify-between items-center mb-4 space-y-3 sm:space-y-0">
          <!-- Search Field -->
          <div class="relative w-full sm:w-1/3">
            <input
              type="text"
              placeholder="{{ currentLanguage === 'sw' ? 'Tafuta huduma...' : 'Search services...' }}"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
              (input)="applyFilter($event)"
            />
            <mat-icon class="absolute right-3 top-2.5 text-gray-400">search</mat-icon>
          </div>

          <!-- Action Buttons -->
          <div class="flex space-x-2">
            <button
              mat-raised-button
              color="primary"
              class="flex items-center space-x-1"
              (click)="addService()"
            >
              <mat-icon>add</mat-icon>
              <span>{{ currentLanguage === 'sw' ? 'Ongeza Huduma' : 'Add Service' }}</span>
            </button>

            <button
              mat-stroked-button
              color="accent"
              class="flex items-center space-x-1"
              (click)="renew()"
            >
              <mat-icon>refresh</mat-icon>
              <span>{{ currentLanguage === 'sw' ? 'Sasisha' : 'Refresh' }}</span>
            </button>
          </div>
        </div>

        <!-- ðŸ“‹ Assigned Services Table -->
        <div class="overflow-x-auto rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm">
          <table mat-table [dataSource]="dataSource" matSort class="min-w-full text-sm">

            <!-- Index -->
            <ng-container matColumnDef="index">
              <th mat-header-cell *matHeaderCellDef>#</th>
              <td mat-cell *matCellDef="let element; let i = index">{{ i + 1 }}</td>
            </ng-container>

            <!-- Service Name -->
            <ng-container matColumnDef="service_name">
              <th mat-header-cell *matHeaderCellDef>
                {{ currentLanguage === 'sw' ? 'Jina la Huduma' : 'Service Name' }}
              </th>
              <td mat-cell *matCellDef="let element">
                {{ element.service_name?.[currentLanguage] }}
              </td>
            </ng-container>

            <!-- Description -->
            <ng-container matColumnDef="service_description">
              <th mat-header-cell *matHeaderCellDef>
                {{ currentLanguage === 'sw' ? 'Maelezo' : 'Description' }}
              </th>
              <td mat-cell *matCellDef="let element">
                {{ element.service_description?.[currentLanguage] }}
              </td>
            </ng-container>

            <!-- Price -->
            <ng-container matColumnDef="service_price">
              <th mat-header-cell *matHeaderCellDef>
                {{ currentLanguage === 'sw' ? 'Bei (TZS)' : 'Price (TZS)' }}
              </th>
              <td mat-cell *matCellDef="let element" class="text-indigo-700 font-semibold">
                {{ element.service_price | currency: 'TZS':'symbol-narrow':'1.0-0' }}
              </td>
            </ng-container>

            <!-- Action -->
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef class="text-center">
                {{ currentLanguage === 'sw' ? 'Kitendo' : 'Action' }}
              </th>
              <td mat-cell *matCellDef="let element" class="text-center">
                <button mat-icon-button color="warn" (click)="deleteService(element.service_id)">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>
        </div>

        <mat-paginator [pageSizeOptions]="[10, 25 , 100]" showFirstLastButtons class="mt-6"></mat-paginator>

        <!-- ðŸš« No Data -->
        <div *ngIf="dataSource.data.length === 0" class="text-center text-gray-500 mt-8 text-sm">
          {{ currentLanguage === 'sw' ? 'Hakuna huduma zilizowekwa.' : 'No assigned services found.' }}
        </div>
      </div>
    </main>
  </div>
</div>
